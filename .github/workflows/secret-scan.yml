name: Secret scan

on:
  pull_request:
  push:
    branches:
      - main

permissions:
  contents: read
  pull-requests: read

concurrency:
  group: secret-scan-${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  trufflehog:
    name: TruffleHog secret scan
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Run TruffleHog
        uses: trufflesecurity/trufflehog-actions-scan@v3
        # For stricter supply-chain security, pin to a commit SHA instead of a tag:
        # uses: trufflesecurity/trufflehog-actions-scan@<commit-sha>
        # inputs are optional; defaults are sensible. Uncomment to reduce false positives:
        # with:
        #   scanArguments: --only-verified


